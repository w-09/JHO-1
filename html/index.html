<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å—ä¸€è™•-äºç£å·¥å‹™æ‰€</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Noto Sans TC', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            padding-top: 60px;
            padding-bottom: 70px;
        }
        
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background-color: #1a73e8;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 800px;
        }
        
        .header-logo {
            height: 40px;
            margin-right: 10px;
        }
        
        .header h1 {
            font-size: 20px;
            font-weight: 500;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #1a73e8;
            display: flex;
            align-items: center;
        }
        
        h2 .material-icons {
            margin-right: 5px;
            font-size: 20px;
        }
        
        /* å…¬å‘Šæ¬„æ¨£å¼ */
        .bulletin-entry {
            background-color: #f9f9f9;
            border-left: 5px solid #3e9956;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .bulletin-entry:hover {
            transform: translateX(10px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .loading {
            text-align: center;
            color: #3e9956;
            padding: 20px;
            font-size: 16px;
        }

        .entry-title {
            font-weight: bold;
            color: #2c7a3f;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .entry-content {
            color: #333;
            margin-bottom: 10px;
        }

        .entry-date {
            color: #888;
            text-align: right;
            font-size: 0.8em;
        }
        
        /* æ›´å¤šæŒ‰éˆ• */
        .view-more-btn {
            display: block;
            text-align: center;
            padding: 10px;
            background-color: #f5f5f5;
            color: #1a73e8;
            border-radius: 5px;
            margin-top: 10px;
            text-decoration: none;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        
        .view-more-btn:hover {
            background-color: #e0e0e0;
        }
        
        /* å·¥æœŸå€’æ•¸è¨ˆæ™‚å™¨ */
        .countdown-timer {
            text-align: center;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid #e0e0e0;
        }
        
        .countdown-timer h3 {
            margin-bottom: 10px;
            color: #1a73e8;
        }
        
        .countdown-timer .timer {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .countdown-timer .time-block {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .countdown-timer .time-value {
            font-size: 24px;
            font-weight: bold;
            background-color: #1a73e8;
            color: white;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
        }
        
        .countdown-timer .time-label {
            margin-top: 5px;
            font-size: 12px;
            color: #666;
        }
        
        /* éƒ¨é–€æŒ‰éˆ•å®¹å™¨æ¨£å¼ */
        .btn-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn {
            display: block;
            background-color: #1a73e8;
            color: white;
            padding: 12px 15px;
            border-radius: 8px;
            text-decoration: none;
            text-align: center;
            font-weight: 500;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #1557b0;
        }
        
        /* éŒ¯èª¤è¨Šæ¯æ¨£å¼ */
        .error-message {
            background-color: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            margin: 10px 0;
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background-color: white;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 -2px 4px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #666;
            text-decoration: none;
            font-size: 12px;
        }
        
        .nav-item.active {
            color: #1a73e8;
        }
        
        .nav-item i {
            font-size: 24px;
            margin-bottom: 4px;
        }
        
        /* é‡å°å°è¢å¹•è£ç½®çš„éŸ¿æ‡‰å¼èª¿æ•´ */
        @media (max-width: 768px) {
            .btn-container {
                flex-direction: column;
            }
            
            .btn-group {
                width: 100%;
            }
            
            .countdown-timer .timer {
                flex-wrap: wrap;
            }
            
            .countdown-timer .time-value {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .header-logo {
                height: 30px;
            }
            
            .header h1 {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <img src="https://i.postimg.cc/ZKWfsQD9/Logo-02-0.png" alt="Logo" class="header-logo">
            <h1>äºç£å·¥åœ°</h1>
        </div>
    </header>
    
    <div class="container">
        <!-- å·¥æœŸå€’æ•¸è¨ˆæ™‚å™¨ -->
        <section id="countdown">
            <h2><i class="material-icons">timer</i> æ™‚é–“å¿«åˆ°äº†</h2>
            <div class="card">
                <div class="countdown-timer">
                    <h3>å·¥ç¨‹é è¨ˆå®Œå·¥æ™‚é–“</h3>
                    <div class="timer">
                        <div class="time-block">
                            <div id="days" class="time-value">00</div>
                            <div class="time-label">å¤©</div>
                        </div>
                        <div class="time-block">
                            <div id="hours" class="time-value">00</div>
                            <div class="time-label">æ™‚</div>
                        </div>
                        <div class="time-block">
                            <div id="minutes" class="time-value">00</div>
                            <div class="time-label">åˆ†</div>
                        </div>
                        <div class="time-block">
                            <div id="seconds" class="time-value">00</div>
                            <div class="time-label">ç§’</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- å…¬å‘Šæ¬„ç›´æ¥é¡¯ç¤ºåœ¨é¦–é  -->
        <section id="bulletin">
            <h2><i class="material-icons">campaign</i> æœ€æ–°å…¬å‘Š</h2>
            <div class="card">
                <div id="bulletin-entries" class="loading">
                    è¼‰å…¥å…¬å‘Šä¸­...
                </div>
                <a href="#" id="view-more-btn" class="view-more-btn" style="display:none;">
                    æŸ¥çœ‹æ›´å¤šå…¬å‘Š
                </a>
            </div>
        </section>
        
        <section id="departments">
            <h2><i class="material-icons">business</i> å„çµ„é€£çµ</h2>
            <div class="card">
                <div class="btn-container">
                    <div class="btn-group">
                        <p style="color: #1a73e8; font-size: 18px; margin-bottom: 10px;">æ–½å·¥çµ„</p>
                        <a href="https://docs.google.com/spreadsheets/d/1_jZbDPtyy7cO3cA0VwdrQGD6sbkIz0tzjLnnktIbVFw/edit?gid=0#gid=0" class="btn">æ©Ÿé—œæ—¥å ±</a>
                        <a href="https://docs.google.com/spreadsheets/d/1BxXg5jEgVMVnT5uBZGIEUoEs7GHX90Aent1j9mCZWD8/edit?gid=0#gid=0" class="btn">æ–½å·¥è‡ªä¸»æŸ¥é©—</a>
                        <a href="https://docs.google.com/spreadsheets/d/1JaZEKyh_M6bWk_I3p-jWH1cL6htITDyfzwwzSb3mbcc/edit?gid=442371140#gid=442371140" class="btn">æ··å‡åœŸæ¾†ç½®çµ±è¨ˆ</a>
                        <a href="https://docs.google.com/spreadsheets/d/1LtNOr7zsmdIlIMaf4jUn77W6LCdlxh3rcCXPcvXafkw/edit?gid=0#gid=0" class="btn">ç¼ºå¤±æ”¹å–„ç´€éŒ„</a>
                        <a href="https://docs.google.com/spreadsheets/d/1QP7HbrNo5MCdGsvQsY1hUy2ufkkg3hwsgfDL917FkBo/edit?gid=0#gid=0" class="btn">æ–½å·¥é€²åº¦å–ç·šåœ–</a>
                        <a href="https://w-09.github.io/form/Untitled-1.html" class="btn">æ¯æ—¥é€²å ´äººæ•¸å›å ±</a>
                        <a href="https://docs.google.com/spreadsheets/d/14bCNRHbODeUyE_SoTtciLrtRKutp8AFP7W0S_KJQPPg/edit?gid=250419685#gid=250419685" class="btn">æ–½å·¥åœ–åœ–æ§</a>
                    </div>
                    <div class="btn-group">
                        <p style="color: #1a73e8; font-size: 18px; margin-bottom: 10px;">å“ç®¡çµ„</p>
                        <a href="https://docs.google.com/spreadsheets/d/13dLwyMfSB_O8V2oHDqnUeV__RnNFalBGPllYWnyXaPw/edit?gid=0#gid=0" class="btn">æ··å‡åœŸæ¾†ç½®æ™‚é–“ç´€éŒ„(1)</a>
                        <a href="https://docs.google.com/spreadsheets/d/120XZPrVJ45FkId1PKj4Weov0lcDOhBsThOSnPlg3A3A/edit?usp=sharing" class="btn">æ··å‡åœŸæ¾†ç½®æ™‚é–“ç´€éŒ„(2)</a>
                        <a href="https://docs.google.com/spreadsheets/d/1ymHlbXo8yzJ8XCd9djMdBSwjwIqwsGdUfdDd4OE8nio/edit?gid=281744822#gid=281744822" class="btn">æ”¶/ç™¼æ–‡ç´€éŒ„</a>
                        <a href="https://docs.google.com/spreadsheets/d/13Zf7l9bKjapzaQGxyRAc-qeVmdWNmFhGxPd2ziPnEJw/edit?gid=0#gid=0" class="btn">å·¥ç¨‹ç›¸é—œäººå“¡ç£å°ç´€éŒ„</a>
                        <a href="https://docs.google.com/spreadsheets/d/1i1TBepz7SEm0KRRCbRYntfTcCA7ZKUgRRwDaWJ1nMqU/edit?gid=1342178985#gid=1342178985" class="btn">çŸ¯æ­£é é˜²/æ°¸é’è‡ªä¸»ç¼ºå¤±çµ±è¨ˆ</a>
                        <a href="https://docs.google.com/spreadsheets/d/1MK7jePCQ2Yjm26yTVvdctfMCOfXwiGLiSxy-LPc3ERc/edit?gid=1616629558#gid=1616629558" class="btn">ææ–™è¨­å‚™çµ±è¨ˆè¡¨/ç”³è«‹å–®</a>
                        <a href="https://docs.google.com/spreadsheets/d/1VSqgrKHe_KrP5BHJQ6HIQPMPAN5njZ1Klte9S6x9TSA/edit?gid=656392846#gid=656392846" class="btn">é‹¼ç­‹é€²å ´çµ±è¨ˆ</a>
                        <a href="https://docs.google.com/spreadsheets/d/15upHRzj2BciKvpJaTAXYmYF9JkKQIyGE5iJFfRYFCm8/edit?gid=1766218997#gid=1766218997" class="btn">ç®¡åˆ¶ç¸½è¡¨</a>
                    </div>
                    <div class="btn-group">
                        <p style="color: #1a73e8; font-size: 18px; margin-bottom: 10px;">è¡Œæ”¿çµ„</p>
                        <a href="https://docs.google.com/spreadsheets/d/1DZa-5tN-KdqLg9TXe-YYKJ-qjJl5MB5bF_MU0RCj_iY/edit?gid=0#gid=0" class="btn">äºç£é€šè¨ŠéŒ„</a>
                        <a href="https://docs.google.com/spreadsheets/d/1kBVdvBb7IxcNXlKKfV0XHAN1SzuaHmAR9ndvdUEK7Tg/edit?gid=0#gid=0" class="btn">å…¬å‘Šç®¡ç†è¡¨</a>
                    </div>
                </div>
            </div>
        </section>
    </div>
    
    <nav class="bottom-nav">
        <a href="#" class="nav-item active">
            <i class="material-icons">home</i>
            <span>é¦–é </span>
        </a>
        <a href="#bulletin" class="nav-item">
            <i class="material-icons">campaign</i>
            <span>å…¬å‘Š</span>
        </a>
        <a href="#" class="nav-item">
            <i class="material-icons">description</i>
            <span>æ–‡ä»¶(å°šæœªé–‹ç™¼)</span>
        </a>
        <a href="#" class="nav-item">
            <i class="material-icons">person</i>
            <span>å€‹äºº(å°šæœªé–‹ç™¼)</span>
        </a>
    </nav>
    
    <script>
        // Googleè©¦ç®—è¡¨çš„å…¬é–‹ç™¼ä½ˆCSVç¶²å€
        const SPREADSHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRC4HgLq2IE7lKm4lixBvo0X4f6Erl6JdW6prqkrr83AypmGiwfnUCyCFXcoN_KfNbGCvUu5u6vHXp5/pub?output=csv';
        
        // å·¥æœŸå€’æ•¸è¨ˆæ™‚å™¨
        function updateCountdown() {
            // è¨­å®šç›®æ¨™æ—¥æœŸ (2026å¹´12æœˆ25æ—¥)
            const targetDate = new Date('2026-12-25T00:00:00');
            const currentDate = new Date();
            
            // è¨ˆç®—å‰©é¤˜æ™‚é–“
            const timeLeft = targetDate - currentDate;
            
            // å¦‚æœå·²ç¶“éäº†ç›®æ¨™æ—¥æœŸ
            if (timeLeft <= 0) {
                document.getElementById('days').textContent = '00';
                document.getElementById('hours').textContent = '00';
                document.getElementById('minutes').textContent = '00';
                document.getElementById('seconds').textContent = '00';
                return;
            }
            
            // è¨ˆç®—å¤©ã€æ™‚ã€åˆ†ã€ç§’
            const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
            const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            // æ›´æ–°é¡¯ç¤º
            document.getElementById('days').textContent = days.toString().padStart(2, '0');
            document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
            document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
            document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
        }
        
        // æ¯ç§’æ›´æ–°ä¸€æ¬¡å€’æ•¸è¨ˆæ™‚
        updateCountdown();
        setInterval(updateCountdown, 1000);
        
        // é é¢è¼‰å…¥æ™‚ç›´æ¥ç²å–å…¬å‘Š
        document.addEventListener('DOMContentLoaded', fetchBulletinEntries);
        
        // å¾è©¦ç®—è¡¨è¼‰å…¥å…¬å‘Šè³‡æ–™
        async function fetchBulletinEntries() {
            try {
                console.log("é–‹å§‹è¼‰å…¥å…¬å‘Šè³‡æ–™...");
                // ä½¿ç”¨ fetch API ç²å– CSV æ•¸æ“š
                const response = await fetch(SPREADSHEET_CSV_URL);
                
                if (!response.ok) {
                    throw new Error(`HTTP éŒ¯èª¤! ç‹€æ…‹: ${response.status}`);
                }
                
                const csvText = await response.text();
                console.log("æˆåŠŸç²å–CSVæ•¸æ“š");
                
                // ä½¿ç”¨ PapaParse è§£æ CSV
                Papa.parse(csvText, {
                    complete: function(results) {
                        const entriesContainer = document.getElementById('bulletin-entries');
                        entriesContainer.innerHTML = ''; // æ¸…ç©ºè¼‰å…¥æç¤º
                        
                        // è·³éæ¨™é¡Œåˆ—ï¼Œå¾ç¬¬äºŒåˆ—é–‹å§‹
                        const entries = results.data.slice(1).filter(entry => entry.length > 0 && entry[0] && entry[0].trim() !== '');
                        
                        console.log("éæ¿¾å¾Œçš„æœ‰æ•ˆå…¬å‘Šæ•¸:", entries.length);
                        
                        if (entries.length === 0) {
                            entriesContainer.innerHTML = `
                                <div style="text-align:center; color:#888;">
                                    ç›®å‰å°šç„¡å…¬å‘Š
                                </div>
                            `;
                            return;
                        }
                        
                        // åªé¡¯ç¤ºæœ€æ–°çš„3å‰‡å…¬å‘Š
                        const displayEntries = entries.slice(0, 3);
                        
                        // é¡¯ç¤ºå…¬å‘Š
                        displayEntries.forEach(entry => {
                            const entryDiv = document.createElement('div');
                            entryDiv.className = 'bulletin-entry';
                            
                            const icon = entry[3] || 'ğŸ“¢';
                            const title = entry[0] || 'å…¬å‘Š';
                            const content = entry[1] || 'æš«ç„¡è©³ç´°å…§å®¹';
                            const date = entry[2] || '';
                            
                            entryDiv.innerHTML = `
                                <div class="entry-title">${icon} ${title}</div>
                                <div class="entry-content">${content}</div>
                                <div class="entry-date">${date}</div>
                            `;
                            
                            entriesContainer.appendChild(entryDiv);
                        });
                        
                        // å¦‚æœæœ‰è¶…é3å‰‡å…¬å‘Šï¼Œé¡¯ç¤ºã€ŒæŸ¥çœ‹æ›´å¤šã€æŒ‰éˆ•
                        if (entries.length > 3) {
                            const viewMoreBtn = document.getElementById('view-more-btn');
                            viewMoreBtn.style.display = 'block';
                            
                            // é»æ“Šã€ŒæŸ¥çœ‹æ›´å¤šã€æŒ‰éˆ•æ™‚é¡¯ç¤ºæ‰€æœ‰å…¬å‘Š
                            viewMoreBtn.addEventListener('click', function(e) {
                                e.preventDefault();
                                
                                // æ¸…ç©ºå®¹å™¨
                                entriesContainer.innerHTML = '';
                                
                                // é¡¯ç¤ºæ‰€æœ‰å…¬å‘Š
                                entries.forEach(entry => {
                                    const entryDiv = document.createElement('div');
                                    entryDiv.className = 'bulletin-entry';
                                    
                                    const icon = entry[3] || 'ğŸ“¢';
                                    const title = entry[0] || 'å…¬å‘Š';
                                    const content = entry[1] || 'æš«ç„¡è©³ç´°å…§å®¹';
                                    const date = entry[2] || '';
                                    
                                    entryDiv.innerHTML = `
                                        <div class="entry-title">${icon} ${title}</div>
                                        <div class="entry-content">${content}</div>
                                        <div class="entry-date">${date}</div>
                                    `;
                                    
                                    entriesContainer.appendChild(entryDiv);
                                });
                                
                                // éš±è—ã€ŒæŸ¥çœ‹æ›´å¤šã€æŒ‰éˆ•
                                viewMoreBtn.style.display = 'none';
                                
                                // æ·»åŠ ã€Œé¡¯ç¤ºè¼ƒå°‘ã€æŒ‰éˆ•
                                const showLessBtn = document.createElement('a');
                                showLessBtn.href = '#';
                                showLessBtn.className = 'view-more-btn';
                                showLessBtn.textContent = 'é¡¯ç¤ºè¼ƒå°‘';
                                showLessBtn.addEventListener('click', function(e) {
                                    e.preventDefault();
                                    fetchBulletinEntries(); // é‡æ–°è¼‰å…¥ï¼Œåªé¡¯ç¤ºå‰3å‰‡
                                });
                                
                                entriesContainer.parentNode.appendChild(showLessBtn);
                            });
                        }
                    },
                    error: function(error) {
                        console.error('CSVè§£æéŒ¯èª¤:', error);
                        const entriesContainer = document.getElementById('bulletin-entries');
                        entriesContainer.innerHTML = `
                            <div class="error-message">
                                <h3>ğŸš¨ CSVè§£æéŒ¯èª¤</h3>
                                <p>${error.message}</p>
                                <p>è«‹ç¨å¾Œå†è©¦æˆ–è¯çµ¡ç³»çµ±ç®¡ç†å“¡</p>
                            </div>
                        `;
                    }
                });
            } catch (error) {
                console.error('å…¬å‘Šè¼‰å…¥å¤±æ•—:', error);
                const entriesContainer = document.getElementById('bulletin-entries');
                entriesContainer.innerHTML = `
                    <div class="error-message">
                        <h3>ğŸš¨ è¼‰å…¥éŒ¯èª¤</h3>
                        <p>${error.message}</p>
                        <p>è«‹æª¢æŸ¥ç¶²è·¯é€£æ¥æˆ–è¯çµ¡ç³»çµ±ç®¡ç†å“¡</p>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
